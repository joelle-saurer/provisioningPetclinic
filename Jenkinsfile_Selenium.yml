pipeline {
    
    agent any
 
    tools {
        maven "Maven"
    }

    stages {   
        stage('Launch Application') {
            parallel {
                stage('Launch petclinic') { 
                    steps {
 
                    echo 'deploy application'
                    sh 'mvn deploy -Dmaven.install.skip=true'
                    }
                }
                
                stage('Functional test of web application') { 
                    steps {
                    echo 'Running the Selenium test'
                    sh "python3 '/home/azureuser/petclinic/spring-framework-petclinic/test_petclinic.py'"
                    }
                }    
            }
        }
    }
}